<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="Mr. W">
<meta name="description" content="BG ARK CARNELIAN Draft Survey System">
<title>BG ARK CARNELIAN - Draft Survey</title>

<!-- Favicon -->
<link rel="shortcut icon" href="https://raw.githubusercontent.com/wahid7ark/wahid7ark.github.io/refs/heads/main/icon.png" type="image/x-icon">

<!-- Font -->
<link href="https://fonts.googleapis.com/css?family=Iceland" rel="stylesheet">

<style>
body, html {margin:0;padding:0;background-color:#121212;color:white;font-family:'Iceland',sans-serif;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;}
.container {max-width:720px;width:90%;margin:auto;padding:14px;}
header {text-align:center;margin-bottom:18px;}
header h1 {font-size:26px;letter-spacing:1px;color:#4db8ff;}
header h3 {font-size:14px;font-weight:400;color:#cfd8dc;margin-top:4px;}
header p {font-size:12px;color:#90a4ae;}
.photo img {width:100%;height:auto;max-height:300px;object-fit:cover;border-radius:10px;margin-bottom:12px;}
@media(min-width:900px){.photo img{max-height:400px;}}
.form-grid {display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:12px;}
@media(max-width:480px){.form-grid{grid-template-columns:1fr;}}
.form-row {display:flex;flex-direction:column;margin-bottom:12px;}
label {font-size:12px;color:#b0bec5;margin-bottom:4px;}
input {width:100%;padding:12px 10px;font-size:16px;border:none;border-radius:10px;background:#0f1d25;color:#fff;}
input:focus{outline:none;background:#122a36;box-shadow:0 0 0 2px #4db8ff;}
input::-webkit-outer-spin-button, input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0;}
button {width:100%;padding:16px;margin-top:10px;font-size:18px;font-weight:bold;background:#2fa4ff;border:none;border-radius:12px;color:#fff;letter-spacing:1px;cursor:pointer;}
button:active{transform:scale(0.97);background:#1d8fe0;}
#aboutBtn{background:#4db8ff;color:#fff;margin-top:6px;}
.results{margin-top:12px;text-align:center;}
#output{margin-top:12px;background:#000;padding:16px;border-radius:12px;font-size:14px;line-height:1.6;white-space:pre-wrap;font-family:"Courier New",monospace;}
#output strong{font-size:18px;color:#4db8ff;display:block;margin-top:8px;}
#aboutModal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);justify-content:center;align-items:center;z-index:999;}
#aboutModal .modal-content{background:#162630;padding:20px;border-radius:12px;max-width:400px;text-align:center;}
#aboutModal a{color:#4db8ff;text-decoration:none;}
#aboutModal button{margin-top:12px;}
.formula {display:inline-block;overflow:hidden;border-right:2px solid #00ff99;white-space:nowrap;animation:typing 0.8s steps(30,end) forwards;margin-bottom:6px;}
@keyframes typing {from{width:0;} to{width:100%;}}
</style>
</head>
<body>

<div class="container">
<header>
  <h1>BG ARK CARNELIAN</h1>
  <h3>TechnoLogia Draft Survey System</h3>
  <p>Coder: Mr. Wolf (ARK DAN)</p>
</header> 

<section class="photo">
    <img src="https://raw.githubusercontent.com/wahid7ark/wahid7ark.github.io/main/photo.jpg" alt="BG ARK CARNELIAN">
</section>

<audio autoplay loop style="display:none">
    <source src="https://raw.githubusercontent.com/wahid7ark/wahid7ark.github.io/main/audio.mp3" type="audio/mpeg">
</audio>

<div style="text-align:center;margin-bottom:20px;">
    <h2 style="color:#4db8ff;font-size:22px;">Draft Survey Calculator</h2>
    <p style="color:#cfd8dc;font-size:14px;">Initial & Final Survey</p>
</div>

<section class="survey-section">
  <h2 style="color:#4db8ff;">INITIAL SURVEY</h2>
  <div class="form-grid">
    <div class="form-row"><label for="i_fp">Forward Port</label><input type="number" id="i_fp" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="i_fs">Forward Starboard</label><input type="number" id="i_fs" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="i_mp">Mid Port</label><input type="number" id="i_mp" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="i_ms">Mid Starboard</label><input type="number" id="i_ms" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="i_ap">Aft Port</label><input type="number" id="i_ap" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="i_as">Aft Starboard</label><input type="number" id="i_as" step="0.001" placeholder="m"></div>
  </div>
</section>

<section class="survey-section">
  <h2 style="color:#4db8ff;">FINAL SURVEY</h2>
  <div class="form-grid">
    <div class="form-row"><label for="f_fp">Forward Port</label><input type="number" id="f_fp" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="f_fs">Forward Starboard</label><input type="number" id="f_fs" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="f_mp">Mid Port</label><input type="number" id="f_mp" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="f_ms">Mid Starboard</label><input type="number" id="f_ms" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="f_ap">Aft Port</label><input type="number" id="f_ap" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="f_as">Aft Starboard</label><input type="number" id="f_as" step="0.001" placeholder="m"></div>
  </div>
</section>

<section class="constants-section">
  <h2 style="color:#4db8ff;">CONSTANTS</h2>
  <div class="form-grid" style="grid-template-columns:1fr;">
    <div class="form-row"><label for="density">Observed Density (kg/L)</label><input type="number" id="density" value="1.025" step="0.001"></div>
  </div>
</section>

<button id="calcBtn" type="button">CALCULATE CARGO</button>
<button id="aboutBtn" type="button">ABOUT</button>

<section class="results">
  <h2 style="color:#4db8ff;">RESULTS</h2>
  <div id="output"></div>
</section>

<div id="aboutModal">
  <div class="modal-content">
    <h3>About BG ARK CARNELIAN Draft Survey</h3>
    <p>This app simplifies cargo calculation. Version 1.1 current. Version 1.2 coming soon. Visit <a href="https://github.com/wahid7ark/wahid7ark.github.io/blob/main/carnelian.html" target="_blank">wahid7ark.github.io</a></p>
    <button id="closeAbout">CLOSE</button>
  </div>
</div>

<script>
// ========== FULL HYDROSTATIC TABLE ==========
// For brevity, only partial data shown; fill all rows from your BG ARK CARNELIAN table
const hydroTable = [
{draft:0.5,disp:894.77,lcb:47.171,vcb:0.255,tpc:18.69, lcf:47.315,degTrim:15479,kml:991.07,kmt:100.582},
{draft:0.55,disp:988.53,lcb:47.186,vcb:0.281,tpc:18.83, lcf:47.311,degTrim:15714,kml:910.70,kmt:92.489},
{draft:0.6,disp:1083.03,lcb:47.198,vcb:0.307,tpc:18.98, lcf:47.323,degTrim:15960,kml:844.48,kmt:85.782},
// ... lanjutkan sampai draft 5.000 sesuai tabel lengkap
];

// ========== UTILS ==========
function interpolateValue(draft,key){
  if(isNaN(draft)) return null;
  if(draft <0.5 || draft >5.0) return null;
  for(let i=0;i<hydroTable.length-1;i++){
    let d1=hydroTable[i], d2=hydroTable[i+1];
    if(draft>=d1.draft && draft<=d2.draft){
      let ratio=(draft-d1.draft)/(d2.draft-d1.draft);
      return d1[key]+ratio*(d2[key]-d1[key]);
    }
  }
  return null;
}
function mean(a,b){return (a+b)/2;}
function trueMean(F,M,A){return (((F+A)/2)+((F+M+A)/3))/2;}
function get(id){
  const el=document.getElementById(id);
  if(!el) throw new Error("missing");
  let v=el.value.trim();
  if(v==="") throw new Error("empty");
  let n=parseFloat(v);
  if(isNaN(n)) throw new Error("nan");
  return n;
}

// ========== CALCULATE CARGO ==========
function calculateCargo(){
  const out=document.getElementById("output");
  try{
    let density=parseFloat(document.getElementById("density").value)||1.025;
    let iF=mean(get("i_fp"),get("i_fs"));
    let iM=mean(get("i_mp"),get("i_ms"));
    let iA=mean(get("i_ap"),get("i_as"));
    let fF=mean(get("f_fp"),get("f_fs"));
    let fM=mean(get("f_mp"),get("f_ms"));
    let fA=mean(get("f_ap"),get("f_as"));
    let iMean=trueMean(iF,iM,iA);
    let fMean=trueMean(fF,fM,fA);
    let initDisp=interpolateValue(iMean,'disp')*(density/1.025);
    let finalDisp=interpolateValue(fMean,'disp')*(density/1.025);
    if(initDisp===null||finalDisp===null){
      out.innerHTML="Draft outside hydro table range (0.500 â€“ 5.000 m)";
      return;
    }
    let cargo=finalDisp-initDisp;
    let initKMT=interpolateValue(iMean,'kmt');
    let initKML=interpolateValue(iMean,'kml');
    let initTPC=interpolateValue(iMean,'tpc');
    let finalKMT=interpolateValue(fMean,'kmt');
    let finalKML=interpolateValue(fMean,'kml');
    let finalTPC=interpolateValue(fMean,'tpc');
    const formulas=[
      `// ==== Initial Survey ====`,
      `Mean Draft = ${iMean.toFixed(3)} m`,
      `Displacement = ${initDisp.toFixed(2)} MT`,
      `KMT = ${initKMT.toFixed(2)} | KML = ${initKML.toFixed(2)} | TPC = ${initTPC.toFixed(2)}`,
      `// ==== Final Survey ====`,
      `Mean Draft = ${fMean.toFixed(3)} m`,
      `Displacement = ${finalDisp.toFixed(2)} MT`,
      `KMT = ${finalKMT.toFixed(2)} | KML = ${finalKML.toFixed(2)} | TPC = ${finalTPC.toFixed(2)}`,
      `// ==== NET CARGO ====`,
      `NET CARGO = ${cargo.toFixed(2)} MT`
    ];
    out.innerHTML="";
    let idx=0;
    function showNext(){
      if(idx>=formulas.length) return;
      const line=document.createElement("div");
      line.className="formula";
      line.textContent=formulas[idx];
      out.appendChild(line);
      idx++;
      setTimeout(showNext,200);
    }
    showNext();
  } catch(e){
    out.innerHTML="Please fill ALL draft readings correctly.";
  }
}

// ========== BUTTON & MODAL ==========
window.addEventListener("load",()=>{
  document.getElementById("calcBtn").addEventListener("click",calculateCargo);
  const aboutBtn=document.getElementById("aboutBtn");
  const modal=document.getElementById("aboutModal");
  const closeBtn=document.getElementById("closeAbout");
  aboutBtn.addEventListener("click",()=>{modal.style.display="flex";});
  closeBtn.addEventListener("click",()=>{modal.style.display="none";});
  window.addEventListener("click",e=>{if(e.target===modal) modal.style.display="none";});
});
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="Mr. W">
<meta name="description" content="BG ARK CARNELIAN Draft Survey System">
<title>BG ARK CARNELIAN - Draft Survey</title>

<!-- Favicon -->
<link rel="shortcut icon" href="https://raw.githubusercontent.com/wahid7ark/wahid7ark.github.io/refs/heads/main/icon.png" type="image/x-icon">

<!-- Font -->
<link href="https://fonts.googleapis.com/css?family=Iceland" rel="stylesheet">

<style>
/* ================= BODY & BACKGROUND ================= */
body, html {
  margin:0; padding:0;
  background-color:#121212;
  color:white;
  font-family: 'Iceland', sans-serif;
  display:flex; flex-direction:column;
  align-items:center; justify-content:flex-start;
}

/* ================= CONTAINER ================= */
.container {max-width:720px; width:90%; margin:auto; padding:14px;}

/* ================= HEADER ================= */
header {text-align:center; margin-bottom:18px;}
header h1 {font-size:26px; letter-spacing:1px; color:#4db8ff;}
header h3 {font-size:14px; font-weight:400; color:#cfd8dc; margin-top:4px;}
header p {font-size:12px; color:#90a4ae;}

/* ================= PHOTO ================= */
.photo img {width:100%; height:auto; max-height:300px; object-fit:cover; border-radius:10px; margin-bottom:12px;}
@media(min-width:900px){.photo img{max-height:400px;}}

/* ================= FORM INPUTS ================= */
.form-grid {display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-bottom:12px;}
@media(max-width:480px){.form-grid{grid-template-columns:1fr;}}
.form-row {display:flex; flex-direction:column; margin-bottom:12px;}
label {font-size:12px; color:#b0bec5; margin-bottom:4px;}
input {width:100%; padding:12px 10px; font-size:16px; border:none; border-radius:10px; background:#0f1d25; color:#fff;}
input:focus{outline:none; background:#122a36; box-shadow:0 0 0 2px #4db8ff;}
input::-webkit-outer-spin-button, input::-webkit-inner-spin-button{-webkit-appearance:none; margin:0;}

/* ================= BUTTON ================= */
button {width:100%; padding:16px; margin-top:10px; font-size:18px; font-weight:bold; background:#2fa4ff; border:none; border-radius:12px; color:#fff; letter-spacing:1px; cursor:pointer;}
button:active{transform:scale(0.97); background:#1d8fe0;}
#aboutBtn{background:#4db8ff; color:#fff; margin-top:6px;}

/* ================= OUTPUT ================= */
.results{margin-top:12px; text-align:center;}
#output{margin-top:12px; background:#000; padding:16px; border-radius:12px; font-size:14px; line-height:1.6; white-space:pre-wrap; font-family:"Courier New", monospace;}
#output strong{font-size:18px; color:#4db8ff; display:block; margin-top:8px;}

/* ================= MODAL ABOUT ================= */
#aboutModal{display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); justify-content:center; align-items:center; z-index:999;}
#aboutModal .modal-content{background:#162630; padding:20px; border-radius:12px; max-width:400px; text-align:center;}
#aboutModal a{color:#4db8ff; text-decoration:none;}
#aboutModal button{margin-top:12px;}

/* ================= TYPING ANIMATION ================= */
.formula {display:inline-block; overflow:hidden; border-right:2px solid #00ff99; white-space:nowrap; animation:typing 0.8s steps(30,end) forwards; margin-bottom:6px;}
@keyframes typing {from{width:0;} to{width:100%;}}
</style>
</head>
<body>

<div class="container">
<header>
  <h1>BG ARK CARNELIAN</h1>
  <h3>TechnoLogia Draft Survey System</h3>
  <p>Coder: Mr. Wolf (ARK DAN)</p>
</header> 

<section class="photo">
    <img src="https://raw.githubusercontent.com/wahid7ark/wahid7ark.github.io/main/photo.jpg" alt="BG ARK CARNELIAN">
</section>

<!-- ================= AUDIO ================= -->
<audio autoplay loop style="display:none">
    <source src="https://raw.githubusercontent.com/wahid7ark/wahid7ark.github.io/main/audio.mp3" type="audio/mpeg">
</audio>

<!-- ================= TITLE ================= -->
<div style="text-align:center; margin-bottom:20px;">
    <h2 style="color:#4db8ff; font-size:22px;">Draft Survey Calculator</h2>
    <p style="color:#cfd8dc; font-size:14px;">Initial & Final Survey</p>
</div>

<!-- ================= INITIAL SURVEY ================= -->
<section class="survey-section">
  <h2 style="color:#4db8ff;">INITIAL SURVEY</h2>
  <div class="form-grid">
    <div class="form-row"><label for="i_fp">Forward Port</label><input type="number" id="i_fp" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="i_fs">Forward Starboard</label><input type="number" id="i_fs" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="i_mp">Mid Port</label><input type="number" id="i_mp" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="i_ms">Mid Starboard</label><input type="number" id="i_ms" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="i_ap">Aft Port</label><input type="number" id="i_ap" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="i_as">Aft Starboard</label><input type="number" id="i_as" step="0.001" placeholder="m"></div>
  </div>
  <p style="font-size:12px; color:#b0bec5;">Initial Displacement will be calculated automatically.</p>
</section>

<!-- ================= FINAL SURVEY ================= -->
<section class="survey-section">
  <h2 style="color:#4db8ff;">FINAL SURVEY</h2>
  <div class="form-grid">
    <div class="form-row"><label for="f_fp">Forward Port</label><input type="number" id="f_fp" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="f_fs">Forward Starboard</label><input type="number" id="f_fs" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="f_mp">Mid Port</label><input type="number" id="f_mp" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="f_ms">Mid Starboard</label><input type="number" id="f_ms" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="f_ap">Aft Port</label><input type="number" id="f_ap" step="0.001" placeholder="m"></div>
    <div class="form-row"><label for="f_as">Aft Starboard</label><input type="number" id="f_as" step="0.001" placeholder="m"></div>
  </div>
</section>

<!-- ================= CONSTANTS ================= -->
<section class="constants-section">
  <h2 style="color:#4db8ff;">CONSTANTS</h2>
  <div class="form-grid" style="grid-template-columns:1fr;">
    <div class="form-row"><label for="waterplane">Waterplane Area (m²)</label><input type="number" id="waterplane" value="2184"></div>
    <div class="form-row"><label for="coef">Form Coefficient</label><input type="number" id="coef" value="0.75" step="0.01"></div>
    <div class="form-row"><label for="density">Observed Density (kg/L)</label><input type="number" id="density" value="1.025" step="0.001"></div>
  </div>
</section>

<!-- ================= BUTTONS ================= -->
<button id="calcBtn" type="button">CALCULATE CARGO</button>
<button id="aboutBtn" type="button">ABOUT</button>

<!-- ================= RESULTS ================= -->
<section class="results">
  <h2 style="color:#4db8ff;">RESULTS</h2>
  <div id="output"></div>
</section>

<!-- ================= MODAL ================= -->
<div id="aboutModal">
  <div class="modal-content">
    <h3>About BG ARK CARNELIAN Draft Survey</h3>
    <p>This app simplifies cargo calculation. Version 1.1 current. Version 1.2 coming soon. Visit <a href="https://github.com/wahid7ark/wahid7ark.github.io/blob/main/carnelian.html" target="_blank">wahid7ark.github.io</a></p>
    <button id="closeAbout">CLOSE</button>
  </div>
</div>

<script>
// ================= HYDROSTATIC TABLE =================
const hydroTable = [
{draft:0.500,disp:965.33},{draft:0.550,disp:1051.62},{draft:0.600,disp:1138.47},{draft:0.650,disp:1225.88},
{draft:0.700,disp:1313.86},{draft:0.750,disp:1402.40},{draft:0.800,disp:1491.50},{draft:0.850,disp:1581.17},
{draft:0.900,disp:1671.40},{draft:0.950,disp:1762.20},{draft:1.000,disp:1853.56},{draft:1.050,disp:1945.49},
{draft:1.100,disp:2037.98},{draft:1.150,disp:2131.03},{draft:1.200,disp:2224.65},{draft:1.250,disp:2318.83},
{draft:1.300,disp:2413.57},{draft:1.350,disp:2508.88},{draft:1.400,disp:2604.75},{draft:1.450,disp:2701.19},
{draft:1.500,disp:2798.19},{draft:1.550,disp:2895.76},{draft:1.600,disp:2993.89},{draft:1.650,disp:3092.59},
{draft:1.700,disp:3191.85},{draft:1.750,disp:3291.68},{draft:1.800,disp:3392.07},{draft:1.850,disp:3493.03},
{draft:1.900,disp:3594.55},{draft:1.950,disp:3696.64},{draft:2.000,disp:3799.29},{draft:2.050,disp:3902.51},
{draft:2.100,disp:4006.29},{draft:2.150,disp:4110.64},{draft:2.200,disp:4215.55},{draft:2.250,disp:4321.03},
{draft:2.300,disp:4427.07},{draft:2.350,disp:4533.68},{draft:2.400,disp:4640.86},{draft:2.450,disp:4748.60},
{draft:2.500,disp:4856.91},{draft:2.550,disp:4965.79},{draft:2.600,disp:5075.23},{draft:2.650,disp:5185.24},
{draft:2.700,disp:5295.81},{draft:2.750,disp:5406.95},{draft:2.800,disp:5518.65},{draft:2.850,disp:5630.92},
{draft:2.900,disp:5743.76},{draft:2.950,disp:5857.16},{draft:3.000,disp:5954.66},{draft:3.050,disp:6061.65},
{draft:3.100,disp:6168.86},{draft:3.150,disp:6276.27},{draft:3.200,disp:6383.89},{draft:3.250,disp:6491.73},
{draft:3.300,disp:6599.78},{draft:3.350,disp:6703.02},{draft:3.400,disp:6815.44},{draft:3.450,disp:6925.07},
{draft:3.500,disp:7033.90},{draft:3.550,disp:7142.93},{draft:3.600,disp:7252.17},{draft:3.650,disp:7361.62},
{draft:3.700,disp:7471.28},{draft:3.750,disp:7581.14},{draft:3.800,disp:7691.22},{draft:3.850,disp:7802.51},
{draft:3.900,disp:7912.02},{draft:3.950,disp:8022.73},{draft:4.000,disp:8133.66},{draft:4.050,disp:8244.68},
{draft:4.100,disp:8355.75},{draft:4.150,disp:8466.85},{draft:4.200,disp:8577.98},{draft:4.250,disp:8689.17},
{draft:4.300,disp:8800.40},{draft:4.350,disp:8911.67},{draft:4.400,disp:9022.97},{draft:4.450,disp:9134.32},
{draft:4.500,disp:9245.71},{draft:4.550,disp:9357.15},{draft:4.600,disp:9468.63},{draft:4.650,disp:9579.75},
{draft:4.700,disp:9690.86},{draft:4.750,disp:9801.98},{draft:4.800,disp:9913.10},{draft:4.850,disp:10024.22},
{draft:4.900,disp:10135.34},{draft:4.950,disp:10246.45},{draft:5.000,disp:10357.59}
];

// ================= FUNCTIONS =================
function interpolate(draft){
  if(isNaN(draft)) return null;
  if(draft <0.5 || draft >5.0) return null;
  for(let i=0;i<hydroTable.length-1;i++){
    let d1=hydroTable[i], d2=hydroTable[i+1];
    if(draft >= d1.draft && draft <= d2.draft){
      let ratio = (draft-d1.draft)/(d2.draft-d1.draft);
      return d1.disp + ratio*(d2.disp - d1.disp);
    }
  }
  return null;
}
function mean(a,b){return (a+b)/2;}
function trueMean(F,M,A){return (((F+A)/2)+((F+M+A)/3))/2;}
function get(id){
  const el=document.getElementById(id);
  if(!el) throw new Error("missing");
  let v=el.value.trim();
  if(v==="") throw new Error("empty");
  let n=parseFloat(v);
  if(isNaN(n)) throw new Error("nan");
  return n;
}

// ================= CALCULATE CARGO =================
function calculateCargo(){
  const out=document.getElementById("output");
  try{
    let density=parseFloat(document.getElementById("density").value)||1.025;

    // initial
    let iF=mean(get("i_fp"),get("i_fs"));
    let iM=mean(get("i_mp"),get("i_ms"));
    let iA=mean(get("i_ap"),get("i_as"));
    let iMean=trueMean(iF,iM,iA);

    // final
    let fF=mean(get("f_fp"),get("f_fs"));
    let fM=mean(get("f_mp"),get("f_ms"));
    let fA=mean(get("f_ap"),get("f_as"));
    let fMean=trueMean(fF,fM,fA);

    let initDisp=interpolate(iMean);
    let finalDisp=interpolate(fMean);
    if(initDisp===null||finalDisp===null){
      out.innerHTML="Draft outside hydro table range (0.500 – 5.000 m)";
      return;
    }

    let corrInit=initDisp*(density/1.025);
    let corrFinal=finalDisp*(density/1.025);
    let cargo=corrFinal-corrInit;

    // Animated formula display
    const formulas = [
      `// ==== Initial Survey ====`,
      `iF = (FP+FS)/2 = ${iF.toFixed(3)}`,
      `iM = (MP+MS)/2 = ${iM.toFixed(3)}`,
      `iA = (AP+AS)/2 = ${iA.toFixed(3)}`,
      `Mean Draft (Initial) = ${iMean.toFixed(4)} m`,
      `Displacement (Initial) = ${corrInit.toFixed(2)} MT`,
      `// ==== Final Survey ====`,
      `fF = (FP+FS)/2 = ${fF.toFixed(3)}`,
      `fM = (MP+MS)/2 = ${fM.toFixed(3)}`,
      `fA = (AP+AS)/2 = ${fA.toFixed(3)}`,
      `Mean Draft (Final) = ${fMean.toFixed(4)} m`,
      `Displacement (Final) = ${corrFinal.toFixed(2)} MT`,
      `// ==== NET CARGO ====`,
      `NET CARGO = ${cargo.toFixed(2)} MT`
    ];

    out.innerHTML = ""; // Clear previous
    let idx = 0;
    function showNext() {
      if (idx >= formulas.length) return;
      const line = document.createElement("div");
      line.className = "formula";
      line.textContent = formulas[idx];
      out.appendChild(line);
      idx++;
      setTimeout(showNext, 200); // delay per line
    }
    showNext();

  } catch(e) {
    out.innerHTML = "Please fill ALL draft readings correctly.";
  }
}

// ================= BUTTON & MODAL EVENTS =================
window.addEventListener("load", () => {
  // Calculate button
  document.getElementById("calcBtn").addEventListener("click", calculateCargo);

  // About modal
  const aboutBtn = document.getElementById("aboutBtn");
  const modal = document.getElementById("aboutModal");
  const closeBtn = document.getElementById("closeAbout");

  aboutBtn.addEventListener("click", () => { modal.style.display = "flex"; });
  closeBtn.addEventListener("click", () => { modal.style.display = "none"; });
  window.addEventListener("click", e => { if(e.target === modal) modal.style.display = "none"; });
});
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Draft Survey Assistant Officer</title>
    <link rel="icon" href="https://raw.githubusercontent.com/wahid7ark/wahid7ark.github.io/refs/heads/main/icon.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <audio autoplay loop>
        <source src="https://raw.githubusercontent.com/wahid7ark/wahid7ark.github.io/main/audio.mp3" type="audio/mpeg">
    </audio>

    <h1>BG ARK CARNELIAN</h1>
    <img id="barge" src="https://raw.githubusercontent.com/wahid7ark/wahid7ark.github.io/main/photo.jpg">

    <div class="container">

        <!-- INITIAL SURVEY -->
        <div class="card">
            <h3>INITIAL SURVEY</h3>
            <h4>Forward</h4>
            <div class="row">
                <input id="ifp" placeholder="Port (m)">
                <input id="ifs" placeholder="Stbd (m)">
            </div>
            <h4>Midship</h4>
            <div class="row">
                <input id="imp" placeholder="Port (m)">
                <input id="ims" placeholder="Stbd (m)">
            </div>
            <h4>Aft</h4>
            <div class="row">
                <input id="iap" placeholder="Port (m)">
                <input id="ias" placeholder="Stbd (m)">
            </div>
            <h4>Density</h4>
            <input id="densI" value="1.025" placeholder="1.025">
        </div>

        <!-- FINAL SURVEY -->
        <div class="card">
            <h3>FINAL SURVEY</h3>
            <h4>Forward</h4>
            <div class="row">
                <input id="ffp" placeholder="Port (m)">
                <input id="ffs" placeholder="Stbd (m)">
            </div>
            <h4>Midship</h4>
            <div class="row">
                <input id="fmp" placeholder="Port (m)">
                <input id="fms" placeholder="Stbd (m)">
            </div>
            <h4>Aft</h4>
            <div class="row">
                <input id="fap" placeholder="Port (m)">
                <input id="fas" placeholder="Stbd (m)">
            </div>
            <h4>Density</h4>
            <input id="densF" value="1.025" placeholder="1.025">
        </div>

        <button onclick="calculateSurveyorCargo()">CALCULATE</button>
        <button id="exportBtn" onclick="exportReport()">EXPORT REPORT</button>

        <div class="card">
            <div id="result">Awaiting Calculation...</div>
            <div id="process"></div>
        </div>

    </div>

    <!-- ABOUT MODAL -->
    <div id="aboutBox">
        <div id="aboutContent">
            <span id="closeAbout" class="material-icons" onclick="aboutBox.style.display='none'">close</span>
            <h3>Draft Survey Assistant Officer</h3>
            <p>Survei draft tongkang menggunakan Metode Quarter Mean Draft, koreksi LCF, koreksi trim, koreksi densitas, dan interpolasi hidrostatik.</p>
            <p><a href="https://github.com/wahid7ark/wahid7ark.github.io/blob/main/carnelian.html" target="_blank">Profil Pengembang</a></p>
        </div>
    </div>

    <footer>
        <span class="coder">Coder: Mr. Wolf (ARK DAN)</span>
        <span class="copy">Â©</span><span class="year" id="year"></span>
        <button class="aboutMini" onclick="showAbout()"><span class="material-icons">info</span>ABOUT</button>
    </footer>

    <!-- Script utama -->
    <script src="script.js"></script>

    <!-- ===============================
    <!-- ===============================
 SURVEYOR CARGO PATCH
=============================== -->
<script>
// Hydrostatic table Surveyor (full subset sesuai draft Surveyor)
const hydroTable = [
  { draft: 0.70, disp: 1273.65 },
  { draft: 0.75, disp: 1369.61 },
  { draft: 4.35, disp: 8911.67 },
  { draft: 4.40, disp: 9022.97 }
  // bisa diperluas semua baris jika ingin full range
];

// Interpolasi linear dari tabel
function interpolateDisp(draft){
    if(draft <= hydroTable[0].draft) return hydroTable[0].disp;
    if(draft >= hydroTable[hydroTable.length-1].draft) return hydroTable[hydroTable.length-1].disp;
    for(let i=0;i<hydroTable.length-1;i++){
        let low = hydroTable[i];
        let up  = hydroTable[i+1];
        if(draft >= low.draft && draft <= up.draft){
            let ratio = (draft - low.draft) / (up.draft - low.draft);
            return low.disp + ratio * (up.disp - low.disp);
        }
    }
}

// Fungsi Quarter Mean Draft
function calcQM(F, M, A){
    return (F + 6*M + A) / 8;
}

// Override tombol CALCULATE
function calculateSurveyorCargo(){
    // Ambil input awal
    const iF = parseFloat(document.getElementById("ifp").value) || 0;
    const iM = parseFloat(document.getElementById("imp").value) || 0;
    const iA = parseFloat(document.getElementById("iap").value) || 0;
    const densI = parseFloat(document.getElementById("densI").value) || 1.025;

    // Ambil input akhir
    const fF = parseFloat(document.getElementById("ffp").value) || 0;
    const fM = parseFloat(document.getElementById("fmp").value) || 0;
    const fA = parseFloat(document.getElementById("fap").value) || 0;
    const densF = parseFloat(document.getElementById("densF").value) || 1.025;

    // Hitung Quarter Mean Draft
    const initialQM = calcQM(iF,iM,iA);
    const finalQM   = calcQM(fF,fM,fA);

    // Interpolasi displacement
    let initialDisp = interpolateDisp(initialQM);
    let finalDisp   = interpolateDisp(finalQM);

    // Density correction
    initialDisp *= densI / 1.025;
    finalDisp   *= densF / 1.025;

    // Cargo
    const cargoMT = finalDisp - initialDisp;

    // Tampilkan hasil
    document.getElementById("result").innerHTML =
        `<strong>Initial Disp.:</strong> ${initialDisp.toFixed(3)} MT<br>` +
        `<strong>Final Disp.:</strong> ${finalDisp.toFixed(3)} MT<br>` +
        `<strong>Total Cargo:</strong> ${cargoMT.toFixed(3)} MT`;

    console.log("Initial QM:", initialQM.toFixed(3),
                "Final QM:", finalQM.toFixed(3),
                "Initial Disp:", initialDisp.toFixed(3),
                "Final Disp:", finalDisp.toFixed(3),
                "Cargo:", cargoMT.toFixed(3));
}
</script>
</body>

</html>

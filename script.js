// ======================================================
// BG ARK CARNELIAN â€” SURVEYOR CALCULATION ENGINE
// Quarter Mean Draft + Hydrostatic Interpolation
// + TRIM CORRECTION (MCT) + LCF + Density
// ======================================================

// HYDROSTATIC TABLE BG ARK CARNELIAN (FULL)
const hydroTable = [
{d:0.50,disp:894.77,LCB:47.171,VCB:0.255,TPC:18.69,LCF:47.315,MCT:15479,KML:991.07,KMT:100.582},
{d:0.55,disp:988.53,LCB:47.186,VCB:0.281,TPC:18.83,LCF:47.311,MCT:15714,KML:910.70,KMT:92.489},
{d:0.60,disp:1083.03,LCB:47.198,VCB:0.307,TPC:18.98,LCF:47.323,MCT:15960,KML:844.48,KMT:85.782},
{d:0.65,disp:1178.16,LCB:47.209,VCB:0.333,TPC:19.08,LCF:47.350,MCT:16186,KML:787.08,KMT:79.408},
{d:0.70,disp:1273.65,LCB:47.221,VCB:0.358,TPC:19.15,LCF:47.413,MCT:16385,KML:736.55,KMT:73.704},
{d:0.75,disp:1369.61,LCB:47.234,VCB:0.384,TPC:19.25,LCF:47.464,MCT:16626,KML:688.47,KMT:68.935},
{d:0.80,disp:1465.98,LCB:47.249,VCB:0.410,TPC:19.33,LCF:47.528,MCT:16889,KML:660.01,KMT:64.846},
{d:0.85,disp:1562.73,LCB:47.262,VCB:0.436,TPC:19.41,LCF:47.514,MCT:17051,KML:625.10,KMT:61.060},
{d:0.90,disp:1659.80,LCB:47.273,VCB:0.461,TPC:19.47,LCF:47.498,MCT:17215,KML:594.19,KMT:57.709},
{d:0.95,disp:1757.18,LCB:47.283,VCB:0.487,TPC:19.53,LCF:47.479,MCT:17377,KML:566.14,KMT:54.714},
{d:1.00,disp:1854.88,LCB:47.293,VCB:0.513,TPC:19.59,LCF:47.454,MCT:17538,KML:541.69,KMT:52.020},
{d:1.05,disp:1952.88,LCB:47.297,VCB:0.539,TPC:19.65,LCF:47.436,MCT:17702,KML:519.31,KMT:49.594},
{d:1.10,disp:2051.19,LCB:47.303,VCB:0.565,TPC:19.71,LCF:47.414,MCT:17869,KML:498.06,KMT:47.396},
{d:1.15,disp:2149.82,LCB:47.305,VCB:0.590,TPC:19.62,LCF:47.095,MCT:17632,KML:469.89,KMT:45.169},
{d:1.20,disp:2248.17,LCB:47.298,VCB:0.616,TPC:19.70,LCF:47.102,MCT:17843,KML:454.12,KMT:43.356},
{d:1.25,disp:2346.78,LCB:47.289,VCB:0.642,TPC:19.75,LCF:47.054,MCT:17997,KML:438.33,KMT:41.697},
{d:1.30,disp:2445.67,LCB:47.280,VCB:0.667,TPC:19.81,LCF:47.032,MCT:18152,KML:425.22,KMT:40.166},
{d:1.35,disp:2544.82,LCB:47.270,VCB:0.693,TPC:19.85,LCF:47.029,MCT:18278,KML:411.47,KMT:38.679},
{d:1.40,disp:2644.22,LCB:47.260,VCB:0.719,TPC:19.91,LCF:47.008,MCT:18438,KML:395.49,KMT:37.365},
{d:1.45,disp:2743.90,LCB:47.251,VCB:0.745,TPC:19.97,LCF:46.987,MCT:18600,KML:386.36,KMT:36.143},
{d:1.50,disp:2843.86,LCB:47.241,VCB:0.770,TPC:20.03,LCF:46.959,MCT:18770,KML:376.22,KMT:35.020},
{d:1.55,disp:2944.31,LCB:47.231,VCB:0.795,TPC:20.09,LCF:46.955,MCT:18947,KML:368.70,KMT:33.959},
{d:1.60,disp:3044.66,LCB:47.221,VCB:0.821,TPC:20.15,LCF:46.945,MCT:19133,KML:360.02,KMT:32.984},
{d:1.65,disp:3145.51,LCB:47.211,VCB:0.848,TPC:20.22,LCF:46.938,MCT:19327,KML:352.01,KMT:32.078},
{d:1.70,disp:3246.64,LCB:47.201,VCB:0.873,TPC:20.27,LCF:46.895,MCT:19471,KML:342.18,KMT:31.199},
{d:1.75,disp:3348.02,LCB:47.190,VCB:0.899,TPC:20.31,LCF:46.851,MCT:19617,KML:335.67,KMT:30.375},
{d:1.80,disp:3449.64,LCB:47.179,VCB:0.925,TPC:20.36,LCF:46.807,MCT:19765,KML:328.25,KMT:29.601},
{d:1.85,disp:3551.51,LCB:47.167,VCB:0.951,TPC:20.42,LCF:46.762,MCT:19915,KML:321.27,KMT:28.873},
{d:1.90,disp:3653.64,LCB:47.154,VCB:0.977,TPC:20.47,LCF:46.717,MCT:20071,KML:314.72,KMT:28.188},
{d:1.95,disp:3756.01,LCB:47.141,VCB:1.003,TPC:20.52,LCF:46.673,MCT:20226,KML:306.54,KMT:27.540},
{d:2.00,disp:3858.64,LCB:47.129,VCB:1.029,TPC:20.57,LCF:46.634,MCT:20376,KML:302.53,KMT:26.916},
{d:2.05,disp:3961.48,LCB:47.115,VCB:1.055,TPC:20.60,LCF:46.620,MCT:20493,KML:296.37,KMT:26.281},
{d:2.10,disp:4064.57,LCB:47.101,VCB:1.081,TPC:20.65,LCF:46.583,MCT:20645,KML:290.55,KMT:25.720},
{d:2.15,disp:4167.90,LCB:47.087,VCB:1.107,TPC:20.70,LCF:46.539,MCT:20785,KML:285.71,KMT:25.181},
{d:2.20,disp:4271.46,LCB:47.073,VCB:1.133,TPC:20.74,LCF:46.493,MCT:20928,KML:280.45,KMT:24.659},
{d:2.25,disp:4375.27,LCB:47.058,VCB:1.159,TPC:20.79,LCF:46.447,MCT:21072,KML:275.52,KMT:24.181},
{d:2.30,disp:4479.31,LCB:47.043,VCB:1.185,TPC:20.84,LCF:46.400,MCT:21217,KML:271.38,KMT:23.718},
{d:2.35,disp:4583.59,LCB:47.029,VCB:1.211,TPC:20.88,LCF:46.352,MCT:21364,KML:267.02,KMT:23.276},
{d:2.40,disp:4688.12,LCB:47.013,VCB:1.237,TPC:20.93,LCF:46.304,MCT:21512,KML:262.85,KMT:22.856},
{d:2.45,disp:4792.89,LCB:46.997,VCB:1.262,TPC:20.98,LCF:46.055,MCT:21349,KML:258.22,KMT:22.396},
{d:2.50,disp:4896.89,LCB:46.972,VCB:1.288,TPC:20.93,LCF:46.006,MCT:21502,KML:251.56,KMT:22.017},
{d:2.55,disp:5001.63,LCB:46.951,VCB:1.314,TPC:20.98,LCF:45.958,MCT:21559,KML:248.68,KMT:21.656},
{d:2.60,disp:5106.61,LCB:46.930,VCB:1.340,TPC:21.03,LCF:45.909,MCT:21920,KML:244.78,KMT:21.312},
{d:2.65,disp:5211.83,LCB:46.910,VCB:1.366,TPC:21.07,LCF:45.867,MCT:21977,KML:241.59,KMT:20.975},
{d:2.70,disp:5317.27,LCB:46.889,VCB:1.392,TPC:21.11,LCF:45.832,MCT:22100,KML:238.71,KMT:20.620},
{d:2.75,disp:5422.93,LCB:46.868,VCB:1.418,TPC:21.16,LCF:45.815,MCT:22260,KML:235.47,KMT:20.308},
{d:2.80,disp:5528.84,LCB:46.846,VCB:1.444,TPC:21.21,LCF:45.780,MCT:22425,KML:232.37,KMT:20.011},
{d:2.85,disp:5634.98,LCB:46.827,VCB:1.470,TPC:21.25,LCF:45.727,MCT:22563,KML:229.40,KMT:19.723},
{d:2.90,disp:5741.32,LCB:46.806,VCB:1.497,TPC:21.29,LCF:45.674,MCT:22704,KML:226.85,KMT:19.443},
{d:2.95,disp:5847.89,LCB:46.785,VCB:1.523,TPC:21.34,LCF:45.621,MCT:22846,KML:223.82,KMT:19.176},
{d:3.00,disp:5954.66,LCB:46.763,VCB:1.549,TPC:21.38,LCF:45.568,MCT:22991,KML:221.20,KMT:18.920},
{d:3.05,disp:6061.65,LCB:46.741,VCB:1.575,TPC:21.42,LCF:45.514,MCT:23139,KML:218.69,KMT:18.674},
{d:3.10,disp:6168.86,LCB:46.719,VCB:1.601,TPC:21.47,LCF:45.454,MCT:23279,KML:216.19,KMT:18.436},
{d:3.15,disp:6276.27,LCB:46.697,VCB:1.627,TPC:21.51,LCF:45.393,MCT:23422,KML:213.79,KMT:18.209},
{d:3.20,disp:6383.89,LCB:46.675,VCB:1.653,TPC:21.55,LCF:45.332,MCT:23566,KML:211.48,KMT:17.990},
{d:3.25,disp:6491.73,LCB:46.652,VCB:1.679,TPC:21.59,LCF:45.269,MCT:23713,KML:209.26,KMT:17.780},
{d:3.30,disp:6599.78,LCB:46.629,VCB:1.705,TPC:21.64,LCF:45.209,MCT:23856,KML:207.09,KMT:17.575},
{d:3.35,disp:6703.02,LCB:46.606,VCB:1.732,TPC:21.66,LCF:45.175,MCT:23958,KML:204.64,KMT:17.348},
{d:3.40,disp:6815.44,LCB:46.583,VCB:1.758,TPC:21.70,LCF:45.120,MCT:24095,KML:202.51,KMT:17.151},
{d:3.45,disp:6925.07,LCB:46.559,VCB:1.784,TPC:21.74,LCF:45.054,MCT:24234,KML:200.48,KMT:16.962},
{d:3.50,disp:7033.90,LCB:46.536,VCB:1.810,TPC:21.78,LCF:45.008,MCT:24373,KML:198.52,KMT:16.779},
{d:3.55,disp:7142.93,LCB:46.512,VCB:1.836,TPC:21.82,LCF:44.951,MCT:24515,KML:196.62,KMT:16.603},
{d:3.60,disp:7252.17,LCB:46.488,VCB:1.863,TPC:21.86,LCF:44.883,MCT:24657,KML:194.79,KMT:16.433},
{d:3.65,disp:7361.62,LCB:46.464,VCB:1.889,TPC:21.91,LCF:44.835,MCT:24802,KML:193.02,KMT:16.269},
{d:3.70,disp:7471.28,LCB:46.440,VCB:1.915,TPC:21.95,LCF:44.777,MCT:24948,KML:191.30,KMT:16.111},
{d:3.75,disp:7581.14,LCB:46.416,VCB:1.941,TPC:21.99,LCF:44.718,MCT:25097,KML:189.65,KMT:15.959},
{d:3.80,disp:7691.22,LCB:46.391,VCB:1.968,TPC:22.03,LCF:44.657,MCT:25247,KML:188.05,KMT:15.813},
{d:3.85,disp:7801.51,LCB:46.367,VCB:1.994,TPC:22.07,LCF:44.596,MCT:25399,KML:186.52,KMT:15.671},
{d:3.90,disp:7912.02,LCB:46.342,VCB:2.020,TPC:22.12,LCF:44.535,MCT:25554,KML:185.03,KMT:15.535},
{d:3.95,disp:8022.73,LCB:46.317,VCB:2.047,TPC:22.16,LCF:44.473,MCT:25709,KML:183.59,KMT:15.403},
{d:4.00,disp:8133.66,LCB:46.292,VCB:2.073,TPC:22.20,LCF:44.416,MCT:25856,KML:182.12,KMT:15.271},
{d:4.05,disp:8244.68,LCB:46.263,VCB:2.099,TPC:22.19,LCF:44.449,MCT:25951,KML:179.63,KMT:15.103},
{d:4.10,disp:8355.75,LCB:46.244,VCB:2.125,TPC:22.20,LCF:44.460,MCT:25883,KML:177.46,KMT:14.960},
{d:4.15,disp:8466.85,LCB:46.221,VCB:2.152,TPC:22.21,LCF:44.470,MCT:25916,KML:175.36,KMT:14.822},
{d:4.20,disp:8577.95,LCB:46.199,VCB:2.178,TPC:22.21,LCF:44.481,MCT:25949,KML:173.31,KMT:14.687},
{d:4.25,disp:8689.17,LCB:46.177,VCB:2.204,TPC:22.22,LCF:44.491,MCT:25982,KML:171.31,KMT:14.557},
{d:4.30,disp:8800.40,LCB:46.157,VCB:2.231,TPC:22.23,LCF:44.502,MCT:26015,KML:169.35,KMT:14.431},
{d:4.35,disp:8911.67,LCB:46.137,VCB:2.257,TPC:22.24,LCF:44.512,MCT:26050,KML:167.46,KMT:14.308},
{d:4.40,disp:9022.97,LCB:46.117,VCB:2.283,TPC:22.24,LCF:44.523,MCT:26083,KML:165.61,KMT:14.189},
{d:4.45,disp:9134.32,LCB:46.098,VCB:2.309,TPC:22.25,LCF:44.534,MCT:26118,KML:163.81,KMT:14.073},
{d:4.50,disp:9245.71,LCB:46.080,VCB:2.335,TPC:22.25,LCF:44.545,MCT:26152,KML:162.05,KMT:13.961},
{d:4.55,disp:9357.15,LCB:46.063,VCB:2.361,TPC:22.26,LCF:44.555,MCT:26186,KML:160.33,KMT:13.852},
{d:4.60,disp:9463.63,LCB:46.046,VCB:2.387,TPC:22.20,LCF:44.420,MCT:25957,KML:157.05,KMT:13.739},
{d:4.65,disp:9579.75,LCB:46.027,VCB:2.413,TPC:22.22,LCF:44.466,MCT:26051,KML:155.79,KMT:13.633},
{d:4.70,disp:9690.86,LCB:46.009,VCB:2.439,TPC:22.22,LCF:44.466,MCT:26060,KML:154.06,KMT:13.531},
{d:4.75,disp:9801.99,LCB:45.992,VCB:2.465,TPC:22.22,LCF:44.466,MCT:26069,KML:152.37,KMT:13.431},
{d:4.80,disp:9913.10,LCB:45.975,VCB:2.491,TPC:22.22,LCF:44.466,MCT:26079,KML:150.71,KMT:13.334},
{d:4.85,disp:10024.22,LCB:45.958,VCB:2.517,TPC:22.22,LCF:44.466,MCT:26088,KML:149.10,KMT:13.240},
{d:4.90,disp:10135.34,LCB:45.942,VCB:2.543,TPC:22.22,LCF:44.466,MCT:26097,KML:147.52,KMT:13.148},
{d:4.95,disp:10246.45,LCB:45.926,VCB:2.569,TPC:22.22,LCF:44.466,MCT:26107,KML:145.97,KMT:13.059},
{d:5.00,disp:10357.59,LCB:45.910,VCB:2.595,TPC:22.22,LCF:44.466,MCT:26117,KML:144.46,KMT:12.972}
];

// ================== INTERPOLASI ==================
function interpolate(draft){

let low=null, high=null;

for(let i=0;i<hydroTable.length-1;i++){
if(draft>=hydroTable[i].d && draft<=hydroTable[i+1].d){
low=hydroTable[i];
high=hydroTable[i+1];
break;
}
}

if(!low||!high){
alert("Draft diluar tabel hidrostatik");
return null;
}

let r=(draft-low.d)/(high.d-low.d);

return{
disp: low.disp + r*(high.disp-low.disp),
tpc:  low.TPC  + r*(high.TPC-low.TPC),
lcf:  low.LCF  + r*(high.LCF-low.LCF),
mct:  low.MCT  + r*(high.MCT-low.MCT)
};
}


// ================== HITUNG ==================
document.getElementById("calcBtn").addEventListener("click",function(){

function v(id){return parseFloat(document.getElementById(id).value)||0;}

// initial mean
let iF=(v("ifp")+v("ifs"))/2;
let iM=(v("imp")+v("ims"))/2;
let iA=(v("iap")+v("ias"))/2;
let densI=v("densI")||1.025;

// final mean
let fF=(v("ffp")+v("ffs"))/2;
let fM=(v("fmp")+v("fms"))/2;
let fA=(v("fap")+v("fas"))/2;
let densF=v("densF")||1.025;


// QUARTER MEAN
let iQM=(iF+6*iM+iA)/8;
let fQM=(fF+6*fM+fA)/8;


// TRIM
let iTrim=iA-iF;
let fTrim=fA-fF;


// HYDRO
let iHyd=interpolate(iQM);
let fHyd=interpolate(fQM);
if(!iHyd||!fHyd) return;


// TRIM CORRECTION (MCT method)
function trimCorr(trim,hyd){
let trim_cm=trim*100;
return (trim_cm*hyd.tpc*hyd.lcf)/hyd.mct;
}

let iDisp=iHyd.disp+trimCorr(iTrim,iHyd);
let fDisp=fHyd.disp+trimCorr(fTrim,fHyd);


// DENSITY
iDisp=iDisp*(densI/1.025);
fDisp=fDisp*(densF/1.025);


// CARGO
let cargo=fDisp-iDisp;


// OUTPUT
document.getElementById("result").innerHTML=
"Initial QM : "+iQM.toFixed(3)+" m<br>"+
"Final QM : "+fQM.toFixed(3)+" m<br><br>"+
"Initial Disp : "+iDisp.toFixed(2)+" MT<br>"+
"Final Disp : "+fDisp.toFixed(2)+" MT<br><br>"+
"<b style='font-size:22px;color:#7CFFB2'>CARGO : "+cargo.toFixed(2)+" MT</b>";

});

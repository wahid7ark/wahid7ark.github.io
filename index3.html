<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>BG ARK CARNELIAN – Draft Survey PRO</title>

<style>
body{
    font-family: Arial;
    background:#0f172a;
    color:white;
}
.container{
    width:1000px;
    margin:20px auto;
    background:#1e293b;
    padding:20px;
    border-radius:10px;
}
h1{
    text-align:center;
    color:#38bdf8;
}
.section{
    margin-top:20px;
}
.grid{
    display:grid;
    grid-template-columns: repeat(4,1fr);
    gap:10px;
}
input{
    padding:6px;
}
button{
    margin-top:15px;
    padding:10px;
    width:100%;
    background:#38bdf8;
    border:none;
    font-weight:bold;
    cursor:pointer;
}
.results{
    margin-top:20px;
    background:#0f172a;
    padding:15px;
    border-radius:8px;
}
.report{
    background:white;
    color:black;
    padding:20px;
    display:none;
}
.warning{ color:orange; font-weight:bold; }
.danger{ color:red; font-weight:bold; }

@media print {
    body * { visibility:hidden; }
    .report, .report * { visibility:visible; }
    .report { position:absolute; left:0; top:0; width:100%; }
}
</style>
</head>
<body>

<div class="container">
<h1>BG. ARK CARNELIAN<br>Draft Survey System – PRO</h1>

<div class="section">
<h3>Initial Survey</h3>
<div class="grid">
<input id="ifp" placeholder="Fwd Port">
<input id="ifs" placeholder="Fwd Stbd">
<input id="imp" placeholder="Mid Port">
<input id="ims" placeholder="Mid Stbd">
<input id="iap" placeholder="Aft Port">
<input id="ias" placeholder="Aft Stbd">
<input id="iden" placeholder="Density" value="1.015">
</div>
</div>

<div class="section">
<h3>Final Survey</h3>
<div class="grid">
<input id="ffp" placeholder="Fwd Port">
<input id="ffs" placeholder="Fwd Stbd">
<input id="fmp" placeholder="Mid Port">
<input id="fms" placeholder="Mid Stbd">
<input id="fap" placeholder="Aft Port">
<input id="fas" placeholder="Aft Stbd">
<input id="fden" placeholder="Density" value="1.015">
</div>
</div>

<button onclick="calculate()">CALCULATE</button>
<button onclick="generateReport()">GENERATE PDF REPORT</button>

<div class="results" id="results"></div>
</div>

<div class="report" id="report"></div>

<script>

const hydro = [
{d:0.5, disp:894.77},
{d:0.6, disp:1083.03},
{d:0.7, disp:1273.68},
{d:0.8, disp:1465.98},
{d:0.9, disp:1659.80},
{d:1.0, disp:1854.88},
{d:2.0, disp:3960},
{d:3.0, disp:5950},
{d:4.0, disp:8135.66},
{d:4.1, disp:8357.75},
{d:4.2, disp:8579.99},
{d:4.3, disp:8801.67},
{d:4.4, disp:9023.97},
{d:4.5, disp:9245.71},
{d:5.0, disp:10357.58}
];

const LIGHTSHIP = 1150;
const SUMMER_DISP = 8824;

let finalData = {};

function interp(draft){
for(let i=0;i<hydro.length-1;i++){
if(draft>=hydro[i].d && draft<=hydro[i+1].d){
let d1=hydro[i].d;
let d2=hydro[i+1].d;
let w1=hydro[i].disp;
let w2=hydro[i+1].disp;
return w1 + ((draft-d1)/(d2-d1))*(w2-w1);
}
}
return null;
}

function qm(f,m,a){ return (f + 2*m + a)/4; }
function mean(a,b){ return (a+b)/2; }

function calculate(){

let ifwd = mean(+ifp.value,+ifs.value);
let imid = mean(+imp.value,+ims.value);
let iaft = mean(+iap.value,+ias.value);
let idensity = +iden.value;

let ffwd = mean(+ffp.value,+ffs.value);
let fmid = mean(+fmp.value,+fms.value);
let faft = mean(+fap.value,+fas.value);
let fdensity = +fden.value;

let iqm = qm(ifwd,imid,iaft);
let fqm = qm(ffwd,fmid,faft);

let ftrim = faft - ffwd;

let idisp = interp(iqm);
let fdisp = interp(fqm);

if(!idisp || !fdisp){
results.innerHTML="Draft outside hydrostatic range.";
return;
}

let idispCorr = idisp*(idensity/1.025);
let fdispCorr = fdisp*(fdensity/1.025);
let cargo = fdispCorr - idispCorr;

finalData = {iqm,fqm,idispCorr,fdispCorr,cargo,ftrim};

let overload = fdispCorr>SUMMER_DISP?"<div class='danger'>OVER SUMMER LOAD</div>":"";
let trimWarn = Math.abs(ftrim)>0.5?"<div class='warning'>Significant Trim</div>":"";

results.innerHTML = `
Initial QM: ${iqm.toFixed(4)} m<br>
Final QM: ${fqm.toFixed(4)} m<br><br>
Initial Disp: ${idispCorr.toFixed(2)} MT<br>
Final Disp: ${fdispCorr.toFixed(2)} MT<br><br>
Cargo: <b>${cargo.toFixed(2)} MT</b><br>
Final Trim: ${ftrim.toFixed(3)} m<br>
${trimWarn}${overload}
`;
}

function generateReport(){
if(!finalData.cargo){ alert("Calculate first!"); return; }

let today = new Date().toLocaleString();

report.innerHTML = `
<h2>DRAFT SURVEY REPORT</h2>
<hr>
Vessel: BG. ARK CARNELIAN<br>
LOA: 91.50 m<br>
Breadth: 24.40 m<br>
Depth: 5.50 m<br>
Summer Disp: 8,824 MT<br>
Lightship: 1,150 MT<br><br>

Survey Date: ${today}<br>
<hr>

Initial Quarter Mean Draft: ${finalData.iqm.toFixed(4)} m<br>
Final Quarter Mean Draft: ${finalData.fqm.toFixed(4)} m<br><br>

Initial Displacement (corr): ${finalData.idispCorr.toFixed(2)} MT<br>
Final Displacement (corr): ${finalData.fdispCorr.toFixed(2)} MT<br><br>

<h3>NET CARGO WEIGHT: ${finalData.cargo.toFixed(2)} MT</h3>

Final Trim: ${finalData.ftrim.toFixed(3)} m<br>

<hr>
Method: Quarter Mean Draft + Hydrostatic Interpolation<br>
Water Density Corrected
`;

report.style.display="block";
window.print();
report.style.display="none";
}

</script>
</body>
</html>
